[{"/Users/vamsee/Developer/vNote/vnote/src/App.tsx":"1","/Users/vamsee/Developer/vNote/vnote/src/index.tsx":"2","/Users/vamsee/Developer/vNote/vnote/src/reportWebVitals.ts":"3","/Users/vamsee/Developer/vNote/vnote/src/Main.tsx":"4","/Users/vamsee/Developer/vNote/vnote/src/Vim.tsx":"5","/Users/vamsee/Developer/vNote/vnote/src/hooks/useApi.tsx":"6","/Users/vamsee/Developer/vNote/vnote/src/config.js":"7","/Users/vamsee/Developer/vNote/vnote/src/state/auth/actions.ts":"8","/Users/vamsee/Developer/vNote/vnote/src/state/auth/reducer.ts":"9","/Users/vamsee/Developer/vNote/vnote/src/state/index.ts":"10"},{"size":556,"mtime":1611707175644,"results":"11","hashOfConfig":"12"},{"size":748,"mtime":1631151596395,"results":"13","hashOfConfig":"12"},{"size":425,"mtime":1611707175645,"results":"14","hashOfConfig":"12"},{"size":15437,"mtime":1631067983869,"results":"15","hashOfConfig":"12"},{"size":6607,"mtime":1631152264979,"results":"16","hashOfConfig":"12"},{"size":4587,"mtime":1626117518650,"results":"17","hashOfConfig":"12"},{"size":135,"mtime":1626018216856,"results":"18","hashOfConfig":"12"},{"size":160,"mtime":1630884866181,"results":"19","hashOfConfig":"12"},{"size":444,"mtime":1630981605157,"results":"20","hashOfConfig":"12"},{"size":337,"mtime":1631060782971,"results":"21","hashOfConfig":"12"},{"filePath":"22","messages":"23","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1huwib0",{"filePath":"24","messages":"25","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"28"},{"filePath":"29","messages":"30","errorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"31","messages":"32","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"33","messages":"34","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":1,"source":"35","usedDeprecatedRules":"36"},{"filePath":"37","messages":"38","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"39","messages":"40","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"41","messages":"42","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"43"},{"filePath":"44","messages":"45","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"46","usedDeprecatedRules":"47"},"/Users/vamsee/Developer/vNote/vnote/src/App.tsx",[],"/Users/vamsee/Developer/vNote/vnote/src/index.tsx",["48"],"/Users/vamsee/Developer/vNote/vnote/src/reportWebVitals.ts",[],["49","50"],"/Users/vamsee/Developer/vNote/vnote/src/Main.tsx",["51","52","53","54","55","56","57","58","59","60","61","62","63","64"],"/Users/vamsee/Developer/vNote/vnote/src/Vim.tsx",["65"],"/Users/vamsee/Developer/vNote/vnote/src/hooks/useApi.tsx",["66","67","68","69","70"],"import {useState, useEffect, useCallback} from 'react'\nimport createPersistedState from 'use-persisted-state'\nimport {apiUrl} from '../config'\nconsole.log(\"MODE: \"+apiUrl)\nexport interface IProps {\n    username:string,\n    password:string,\n    fail: ()=>void\n}\n\nexport interface IPayload {\n    path:string,\n    method:string,\n    body:{}|null,\n    callback: (result:any)=>any,\n}\n\nfunction useApi(props:IProps, payload:IPayload){\n\n    const [accessKey, setAccessKey] = useState('')\n    const useRefreshKeyState = createPersistedState('refreshKey')\n    const [refreshKey, setRefreshKey] = useRefreshKeyState('')\n    //const [refreshKey, setRefreshKey] = useState('')\n    const [refreshKeyIsValid, setRefreshKeyIsValid] = useState<null|boolean>(null)\n    // const apiUrl = 'http://127.0.0.1:8000/api/'\n    // const apiUrl = '/api/'\n    const [accessKeyIsValid, setAccessKeyIsValid] = useState<null|boolean>(null)\n\n    const validHttpCodes = [200, 201, 202, 203, 204]\n    \n    const go = useCallback((accessKey)=>{\n        const {body, method, path} = payload\n        console.log('executing GO:'+accessKey)\n        if(method === 'logout'){\n            return logout(payload.callback)\n        }\n        const options = {\n            method: method,\n            headers: {\n            'Content-Type': 'application/json',\n            'Authorization': 'Bearer '+accessKey,\n            },\n            ... (body !== null) && { body: JSON.stringify(body) }\n        }\n        fetch(apiUrl+path,options)\n        .then(response=>{\n            if(!validHttpCodes.includes(response.status)){\n                setAccessKeyIsValid(false)\n            } else {\n                setAccessKeyIsValid(true)\n                response.json()\n                .then(response=>{\n                    payload.callback(response)\n                })\n            }\n        })\n    },[payload])\n\n    function logout(callback:(response:null)=>void){\n        setRefreshKey('')\n        setAccessKey('')\n        setRefreshKeyIsValid(null)\n        setAccessKeyIsValid(null)\n        callback(null)\n    }\n\n    useEffect(()=>{\n        if(accessKeyIsValid===false){\n            console.log('access key is false')\n            // We tried to make a request, but our key is invalid.\n            // We need to use the refresh key\n            const options = {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json', },\n                body: JSON.stringify( {'refresh': refreshKey} ),\n            }\n            fetch(apiUrl+'token/refresh/', options)\n            .then(response=>{\n                if(!validHttpCodes.includes(response.status)){\n                    setRefreshKeyIsValid(false)\n                    // this needs to trigger a login event\n                } else {\n                    response.json()\n                    .then(response=>{\n                        setRefreshKeyIsValid(true)\n                        setAccessKey(response.access)\n                        // setAccessKeyIsValid(true)\n                    })\n                }\n            })\n        }\n    },[accessKeyIsValid])\n\n\n    useEffect(()=>{\n        console.log('responding to change in access key:'+accessKey)\n        go(accessKey)\n    },[accessKey,payload])\n\n    useEffect(()=>{\n        if(refreshKeyIsValid===false){\n            // even after trying to login, the RK is invalid\n            // We must straight up log in.\n            const options = {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    username: props.username,\n                    password: props.password,\n                 })\n            }\n            fetch(apiUrl+'token/', options)\n            .then(response=>{\n                console.log(response.status)\n                if(!validHttpCodes.includes(response.status)){\n                    setAccessKeyIsValid(null)\n                    setRefreshKeyIsValid(null)\n                    props.fail()\n                    console.log('total fail')\n                }\n                else { \n                    console.log('login works')\n                    response.json()\n                    .then(response=>{\n                        setAccessKey(response.access)\n                        setRefreshKey(response.refresh)\n                        // setRefreshKeyIsValid(true)\n                        // setAccessKeyIsValid(true) // Commenting this out disables the loop\n                    })\n                }\n            })\n        }\n\n        \n    },[refreshKeyIsValid])\n\n};\n\nexport default useApi\n",["71","72"],"/Users/vamsee/Developer/vNote/vnote/src/config.js",[],"/Users/vamsee/Developer/vNote/vnote/src/state/auth/actions.ts",[],"/Users/vamsee/Developer/vNote/vnote/src/state/auth/reducer.ts",[],["73","74"],"/Users/vamsee/Developer/vNote/vnote/src/state/index.ts",["75","76"],"import { configureStore, ThunkAction, Action } from '@reduxjs/toolkit';\nimport payload from './auth/reducer'\n\nexport const store = configureStore({\n  reducer: {payload}\n})\n\nexport type AppDispatch = typeof store.dispatch;\nexport type AppState = ReturnType<typeof store.getState>\nexport type RootState = ReturnType<typeof store.getState>\n",["77","78"],{"ruleId":"79","severity":1,"message":"80","line":9,"column":3,"nodeType":"81","messageId":"82","endLine":9,"endColumn":9},{"ruleId":"83","replacedBy":"84"},{"ruleId":"85","replacedBy":"86"},{"ruleId":"79","severity":1,"message":"87","line":1,"column":45,"nodeType":"81","messageId":"82","endLine":1,"endColumn":60},{"ruleId":"88","severity":1,"message":"89","line":109,"column":11,"nodeType":"81","messageId":"90","endLine":109,"endColumn":13},{"ruleId":"91","severity":1,"message":"92","line":192,"column":47,"nodeType":"93","messageId":"94","endLine":192,"endColumn":49},{"ruleId":"95","severity":1,"message":"96","line":193,"column":42,"nodeType":"93","messageId":"97","endLine":193,"endColumn":43},{"ruleId":"91","severity":1,"message":"98","line":208,"column":47,"nodeType":"93","messageId":"94","endLine":208,"endColumn":49},{"ruleId":"99","severity":1,"message":"100","line":297,"column":5,"nodeType":"101","endLine":297,"endColumn":13,"suggestions":"102"},{"ruleId":"91","severity":1,"message":"92","line":321,"column":41,"nodeType":"93","messageId":"94","endLine":321,"endColumn":43},{"ruleId":"91","severity":1,"message":"92","line":324,"column":25,"nodeType":"93","messageId":"94","endLine":324,"endColumn":27},{"ruleId":"103","severity":1,"message":"104","line":342,"column":36,"nodeType":"105","messageId":"106","endLine":342,"endColumn":38},{"ruleId":"91","severity":1,"message":"92","line":449,"column":38,"nodeType":"93","messageId":"94","endLine":449,"endColumn":40},{"ruleId":"91","severity":1,"message":"92","line":475,"column":109,"nodeType":"93","messageId":"94","endLine":475,"endColumn":111},{"ruleId":"91","severity":1,"message":"92","line":475,"column":165,"nodeType":"93","messageId":"94","endLine":475,"endColumn":167},{"ruleId":"91","severity":1,"message":"92","line":490,"column":58,"nodeType":"93","messageId":"94","endLine":490,"endColumn":60},{"ruleId":"91","severity":1,"message":"92","line":493,"column":58,"nodeType":"93","messageId":"94","endLine":493,"endColumn":60},{"ruleId":"79","severity":1,"message":"107","line":1,"column":16,"nodeType":"81","messageId":"82","endLine":1,"endColumn":35},{"ruleId":"108","severity":1,"message":"109","line":43,"column":16,"nodeType":"110","messageId":"111","endLine":43,"endColumn":17,"fix":"112"},{"ruleId":"99","severity":1,"message":"113","line":57,"column":7,"nodeType":"101","endLine":57,"endColumn":16,"suggestions":"114"},{"ruleId":"99","severity":1,"message":"115","line":92,"column":7,"nodeType":"101","endLine":92,"endColumn":25,"suggestions":"116"},{"ruleId":"99","severity":1,"message":"117","line":98,"column":7,"nodeType":"101","endLine":98,"endColumn":26,"suggestions":"118"},{"ruleId":"99","severity":1,"message":"119","line":135,"column":7,"nodeType":"101","endLine":135,"endColumn":26,"suggestions":"120"},{"ruleId":"83","replacedBy":"121"},{"ruleId":"85","replacedBy":"122"},{"ruleId":"83","replacedBy":"123"},{"ruleId":"85","replacedBy":"124"},{"ruleId":"79","severity":1,"message":"125","line":1,"column":26,"nodeType":"81","messageId":"82","endLine":1,"endColumn":37},{"ruleId":"79","severity":1,"message":"126","line":1,"column":39,"nodeType":"81","messageId":"82","endLine":1,"endColumn":45},{"ruleId":"83","replacedBy":"127"},{"ruleId":"85","replacedBy":"128"},"@typescript-eslint/no-unused-vars","'Switch' is defined but never used.","Identifier","unusedVar","no-native-reassign",["129"],"no-negated-in-lhs",["130"],"'useLayoutEffect' is defined but never used.","@typescript-eslint/no-redeclare","'pl' is already defined.","redeclared","eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","no-useless-concat","Unexpected string concatenation of literals.","unexpectedConcat","Expected '!==' and instead saw '!='.","react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'auth', 'getBacklinks', and 'getOutLinks'. Either include them or remove the dependency array.","ArrayExpression",["131"],"array-callback-return","Array.prototype.filter() expects a value to be returned at the end of arrow function.","ArrowFunctionExpression","expectedAtEnd","'useImperativeHandle' is defined but never used.","rest-spread-spacing","Unexpected whitespace after spread property operator.","SpreadElement","unexpectedWhitespace",{"range":"132","text":"133"},"React Hook useCallback has missing dependencies: 'logout' and 'validHttpCodes'. Either include them or remove the dependency array.",["134"],"React Hook useEffect has missing dependencies: 'refreshKey' and 'validHttpCodes'. Either include them or remove the dependency array.",["135"],"React Hook useEffect has a missing dependency: 'go'. Either include it or remove the dependency array.",["136"],"React Hook useEffect has missing dependencies: 'props', 'setRefreshKey', and 'validHttpCodes'. Either include them or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.",["137"],["129"],["130"],["129"],["130"],"'ThunkAction' is defined but never used.","'Action' is defined but never used.",["129"],["130"],"no-global-assign","no-unsafe-negation",{"desc":"138","fix":"139"},[1395,1396],"",{"desc":"140","fix":"141"},{"desc":"142","fix":"143"},{"desc":"144","fix":"145"},{"desc":"146","fix":"147"},"Update the dependencies array to be: [auth, getBacklinks, getOutLinks, postId]",{"range":"148","text":"149"},"Update the dependencies array to be: [logout, payload, validHttpCodes]",{"range":"150","text":"151"},"Update the dependencies array to be: [accessKeyIsValid, refreshKey, validHttpCodes]",{"range":"152","text":"153"},"Update the dependencies array to be: [accessKey, go, payload]",{"range":"154","text":"155"},"Update the dependencies array to be: [props, refreshKeyIsValid, setRefreshKey, validHttpCodes]",{"range":"156","text":"157"},[7198,7206],"[auth, getBacklinks, getOutLinks, postId]",[1845,1854],"[logout, payload, validHttpCodes]",[3066,3084],"[accessKeyIsValid, refreshKey, validHttpCodes]",[3205,3224],"[accessKey, go, payload]",[4539,4558],"[props, refreshKeyIsValid, setRefreshKey, validHttpCodes]"]